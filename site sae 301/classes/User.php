<?php class User{private $conn,$table_name='users';public function __construct($db){$this->conn=$db;}public function login($email,$password){$query="SELECT id,username,password FROM ".$this->table_name." WHERE email=:email LIMIT 1";$stmt=$this->conn->prepare($query);$stmt->bindParam(':email',$email);$stmt->execute();$user=$stmt->fetch(PDO::FETCH_ASSOC);if($user&&password_verify($password,$user['password'])){return$user;}return null;}public function create($username,$email,$password){$query="INSERT INTO ".$this->table_name." (username,email,password) VALUES (:username,:email,:password)";$stmt=$this->conn->prepare($query);$hashed_password=password_hash($password,PASSWORD_BCRYPT);$stmt->bindParam(':username',$username);$stmt->bindParam(':email',$email);$stmt->bindParam(':password',$hashed_password);return$stmt->execute();}}?>
